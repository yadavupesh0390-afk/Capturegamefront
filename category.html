<!doctype html>
<html lang="hi">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Category Products</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">

<style>
body{
  margin:0;
  font-family:Poppins,system-ui;
  background:#f4f7fb;
}

/* HEADER */
.header{
  display:flex;
  align-items:center;
  gap:10px;
  padding:14px;
  background:#fff;
  box-shadow:0 2px 8px rgba(0,0,0,.08);
}

.header i{
  font-size:22px;
  cursor:pointer;
}

.header h3{
  margin:0;
  font-size:18px;
}

/* PRODUCTS */
.products{
  padding:14px;
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(160px,1fr));
  gap:14px;
}

.product-card{
  background:#fff;
  border-radius:14px;
  padding:10px;
  box-shadow:0 4px 12px rgba(0,0,0,.08);
  cursor:pointer;
  transition:.2s;
}

.product-card:hover{
  transform:translateY(-4px);
}

.product-card img{
  width:100%;
  height:140px;
  object-fit:cover;
  border-radius:10px;
}

.product-card h4{
  font-size:14px;
  margin:6px 0 2px;
}

.price{
  color:#16a34a;
  font-weight:600;
  font-size:14px;
}
</style>
</head>

<body>

<!-- HEADER -->
<div class="header">
  <i class="bi bi-arrow-left" onclick="history.back()"></i>
  <h3 id="catTitle"></h3>
</div>

<!-- PRODUCTS -->
<div id="products" class="products"></div>

<script>
const API = "YOUR_API_URL"; // ðŸ”´ CHANGE
const params = new URLSearchParams(location.search);
const category = params.get("cat");
const wid = params.get("wid");

catTitle.innerText = category;

async function loadCategoryProducts(){

  const r = await fetch(
    API + "/api/products/wholesaler/" + wid
  );
  const d = await r.json();

  const list = d.products.filter(
    p => p.category === category
  );

  if(!list.length){
    products.innerHTML = "<p>No products found</p>";
    return;
  }

  products.innerHTML = list.map(p=>`
    <div class="product-card"
      onclick='openDetail(${JSON.stringify(p)})'>
      <img src="${p.images?.[0] || p.image}">
      <h4>${p.productName}</h4>
      <div class="price">â‚¹${p.price}</div>
    </div>
  `).join("");
}

/* ðŸ”¥ PRODUCT DETAIL (reuse existing modal) */
function openDetail(p){
  localStorage.setItem("selectedProduct", JSON.stringify(p));
  location.href = "product-detail.html";
}

loadCategoryProducts();
</script>

</body>
</html>
